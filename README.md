# ğŸµ æ›²ä¸­äºº (AIMusic)

> åˆå¬ä¸è¯†æ›²ä¸­æ„ï¼Œå†å¬å·²æ˜¯æ›²ä¸­äºº

[![Java](https://img.shields.io/badge/Java-21-orange.svg)](https://www.oracle.com/java/)
[![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.3.5-brightgreen.svg)](https://spring.io/projects/spring-boot)
[![License](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)

## ğŸ“– é¡¹ç›®ç®€ä»‹

æ›²ä¸­äººï¼ˆFor the Person in the Songï¼‰æ˜¯ä¸€ä¸ªåŸºäºäººå·¥æ™ºèƒ½çš„éŸ³ä¹æ¨èå’Œé—®ç­”ç³»ç»Ÿã€‚ç”¨æˆ·å¯ä»¥æå‡ºå…³äºäººç”Ÿã€æƒ…æ„Ÿã€ç”Ÿæ´»çš„é—®é¢˜ï¼Œç³»ç»Ÿä¼šé€šè¿‡AIåˆ†æå¹¶æ¨èç›¸å…³çš„æ­Œæ›²ï¼Œç”¨éŸ³ä¹å’Œæ­Œè¯æ¥å›ç­”ç”¨æˆ·çš„ç–‘é—®ã€‚

## âœ¨ ä¸»è¦åŠŸèƒ½

- ğŸ¤– **æ™ºèƒ½é—®ç­”**ï¼šåŸºäºGPT-4çš„AIé—®ç­”ç³»ç»Ÿ
- ğŸµ **éŸ³ä¹æ¨è**ï¼šæ ¹æ®é—®é¢˜å†…å®¹æ¨èç›¸å…³æ­Œæ›²
- ğŸŒ **å¤šè¯­è¨€æ”¯æŒ**ï¼šæ”¯æŒä¸­æ–‡å’Œè‹±æ–‡ç•Œé¢åˆ‡æ¢
- ğŸ¨ **ç°ä»£åŒ–UI**ï¼šå“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯
- ğŸ“Š **APIæ–‡æ¡£**ï¼šé›†æˆKnife4jæä¾›å®Œæ•´çš„APIæ–‡æ¡£
- ğŸ”’ **å®‰å…¨é˜²æŠ¤**ï¼šé›†æˆSpring Securityå®‰å…¨æ¡†æ¶
- ğŸ“ˆ **ç›‘æ§ç®¡ç†**ï¼šSpring Boot Actuatorå¥åº·æ£€æŸ¥å’Œç¼“å­˜ç›‘æ§
- âš¡ **ç¼“å­˜ä¼˜åŒ–**ï¼šCaffeineç¼“å­˜æå‡æ€§èƒ½
- ğŸ›¡ï¸ **å¼‚å¸¸å¤„ç†**ï¼šå…¨å±€å¼‚å¸¸å¤„ç†å’Œæ™ºèƒ½é”™è¯¯è¿‡æ»¤
- ğŸ”§ **é…ç½®ç®¡ç†**ï¼šçµæ´»çš„é…ç½®ç³»ç»Ÿå’Œç¯å¢ƒç®¡ç†

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

### åç«¯æŠ€æœ¯
- **Spring Boot 3.3.5** - ä¸»æ¡†æ¶
- **Spring Web** - Webå¼€å‘
- **Spring Security** - å®‰å…¨æ¡†æ¶
- **Spring Cache** - ç¼“å­˜æŠ½è±¡
- **Thymeleaf** - æ¨¡æ¿å¼•æ“
- **Caffeine** - é«˜æ€§èƒ½ç¼“å­˜
- **Jackson** - JSONå¤„ç†
- **HttpClient5** - HTTPå®¢æˆ·ç«¯
- **Knife4j 4.3.0** - APIæ–‡æ¡£
- **Spring Boot Actuator** - ç›‘æ§ç®¡ç†

### å‰ç«¯æŠ€æœ¯
- **HTML5/CSS3** - é¡µé¢ç»“æ„å’Œæ ·å¼
- **JavaScript** - äº¤äº’é€»è¾‘
- **Thymeleaf** - æœåŠ¡ç«¯æ¸²æŸ“
- **å“åº”å¼è®¾è®¡** - ç§»åŠ¨ç«¯é€‚é…

### å¼€å‘å·¥å…·
- **Java 21** - ç¼–ç¨‹è¯­è¨€
- **Maven** - é¡¹ç›®ç®¡ç†
- **Docker** - å®¹å™¨åŒ–éƒ¨ç½²
- **Spring Boot DevTools** - å¼€å‘å·¥å…·
- **Mockito** - å•å…ƒæµ‹è¯•

### éƒ¨ç½²ä¸è¿ç»´
- **Docker** - å®¹å™¨åŒ–
- **Docker Compose** - å¤šå®¹å™¨ç¼–æ’
- **å¤šç¯å¢ƒé…ç½®** - dev/prod/localç¯å¢ƒåˆ†ç¦»
- **å¥åº·æ£€æŸ¥** - åº”ç”¨çŠ¶æ€ç›‘æ§
- **æ—¥å¿—ç®¡ç†** - ç»“æ„åŒ–æ—¥å¿—è¾“å‡º

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Java 21+
- Maven 3.6+
- ç½‘ç»œè¿æ¥ï¼ˆç”¨äºAIæœåŠ¡è°ƒç”¨ï¼‰

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone <repository-url>
   cd AIMusic
   ```

2. **é…ç½®åº”ç”¨**
   
   é¡¹ç›®æ”¯æŒå¤šç¯å¢ƒé…ç½®ï¼ŒåŒ…å«ä»¥ä¸‹é…ç½®æ–‡ä»¶ï¼š
   - `application.yml` - åŸºç¡€é…ç½®
   - `application-dev.yml` - å¼€å‘ç¯å¢ƒé…ç½®
   - `application-prod.yml` - ç”Ÿäº§ç¯å¢ƒé…ç½®
   - `application-local.yml` - æœ¬åœ°å¼€å‘é…ç½®ï¼ˆä¸æäº¤åˆ°gitï¼‰
   
   **å¼€å‘ç¯å¢ƒï¼ˆé»˜è®¤ï¼‰**ï¼š
   ```bash
   # ä½¿ç”¨å¼€å‘ç¯å¢ƒé…ç½®
   mvn spring-boot:run
   ```
   
   **æœ¬åœ°å¼€å‘**ï¼š
   å¤åˆ¶ `application-dev.yml` ä¸º `application-local.yml`ï¼Œå¹¶é…ç½®ä½ çš„APIå¯†é’¥ï¼š
   ```yaml
   ai:
     base-url: https://api.openai.com/v1
     api-key: your-openai-api-key-here
     model-name: gpt-4
     timeout: 30
   ```
   
   **ç”Ÿäº§ç¯å¢ƒ**ï¼š
   ä½¿ç”¨ç¯å¢ƒå˜é‡é…ç½®æ•æ„Ÿä¿¡æ¯ï¼š
   ```bash
   export AI_BASE_URL=https://api.openai.com/v1
   export AI_API_KEY=your-api-key-here
   export AI_MODEL_NAME=gpt-4
   mvn spring-boot:run -Pprod
   ```

3. **ç¼–è¯‘é¡¹ç›®**
   ```bash
   mvn clean compile
   ```

4. **è¿è¡Œåº”ç”¨**
   ```bash
   mvn spring-boot:run
   ```
   
   æˆ–è€…æ‰“åŒ…åè¿è¡Œï¼š
   ```bash
   mvn clean package -DskipTests
   java -jar target/aimusic-0.0.1-SNAPSHOT.jar
   ```

5. **è®¿é—®åº”ç”¨**
   - ä¸»é¡µï¼šhttp://localhost:8080
   - Knife4j APIæ–‡æ¡£ï¼šhttp://localhost:8080/doc.html
   - Swagger UIï¼šhttp://localhost:8080/swagger-ui.html
   - å¥åº·æ£€æŸ¥ï¼šhttp://localhost:8080/actuator/health
   - ç¼“å­˜ç›‘æ§ï¼šhttp://localhost:8080/api/cache/stats

## ğŸ³ Dockeréƒ¨ç½²

### æ„å»ºDockeré•œåƒ

é¡¹ç›®ä½¿ç”¨å¤šé˜¶æ®µæ„å»ºï¼Œå¯ä»¥ç›´æ¥ä»æºç æ„å»ºï¼š

```bash
# ç›´æ¥ä»æºç æ„å»ºï¼ˆæ¨èï¼‰
docker build -t aimusic:latest .

# æ„å»ºæ—¶æŒ‡å®šç¯å¢ƒ
docker build --build-arg SPRING_PROFILES_ACTIVE=prod -t aimusic:prod .
```

**æ„å»ºä¼˜åŠ¿**ï¼š
- æ— éœ€é¢„ç¼–è¯‘ï¼Œç›´æ¥ä»æºç æ„å»º
- é•œåƒæ›´å°ï¼ˆä½¿ç”¨JREè€ŒéJDKï¼‰
- æ›´å®‰å…¨ï¼ˆérootç”¨æˆ·è¿è¡Œï¼‰
- æ„å»ºä¼˜åŒ–ï¼ˆ.dockerignoreæ’é™¤ä¸å¿…è¦æ–‡ä»¶ï¼‰
- å¥åº·æ£€æŸ¥å†…ç½®

### ç¯å¢ƒå˜é‡é…ç½®

å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿ï¼š
```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶é…ç½®å¿…è¦å‚æ•°ï¼š
```bash
# AIæœåŠ¡é…ç½®
AI_API_KEY=your-actual-api-key
AI_BASE_URL=https://api.openai.com/v1
AI_MODEL_NAME=gpt-4

# å®‰å…¨é…ç½®
SECURITY_USER_NAME=admin
SECURITY_USER_PASSWORD=your-secure-password

# ä»£ç†é…ç½®ï¼ˆå¯é€‰ï¼‰
PROXY_ENABLED=false
```

### è¿è¡Œå®¹å™¨

**åŸºæœ¬è¿è¡Œ**ï¼š
```bash
docker run -d \
  --name aimusic \
  -p 8080:8080 \
  -e SPRING_PROFILES_ACTIVE=prod \
  --env-file .env \
  -v $(pwd)/logs:/app/logs \
  aimusic:latest
```

**å¼€å‘æ¨¡å¼è¿è¡Œ**ï¼š
```bash
docker run -d \
  --name aimusic-dev \
  -p 8080:8080 \
  -e SPRING_PROFILES_ACTIVE=dev \
  -e AI_API_KEY=your-dev-key \
  aimusic:latest
```

### ä½¿ç”¨Docker Composeï¼ˆæ¨èï¼‰

é¡¹ç›®å·²åŒ…å« `docker-compose.yml` æ–‡ä»¶ï¼Œç›´æ¥ä½¿ç”¨ï¼š

```bash
# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f aimusic

# é‡å¯æœåŠ¡
docker-compose restart aimusic

# åœæ­¢æœåŠ¡
docker-compose down

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build
```

**Docker Composeç‰¹æ€§**ï¼š
- è‡ªåŠ¨é‡å¯ç­–ç•¥
- å¥åº·æ£€æŸ¥ç›‘æ§
- æ—¥å¿—å·æŒ‚è½½
- ç½‘ç»œéš”ç¦»
- ç¯å¢ƒå˜é‡ç®¡ç†

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å»ºè®®

1. **èµ„æºé™åˆ¶**ï¼š
```yaml
services:
  aimusic:
    deploy:
      resources:
        limits:
          cpus: '1.0'
          memory: 1G
        reservations:
          cpus: '0.5'
          memory: 512M
```

2. **æ—¥å¿—ç®¡ç†**ï¼š
```yaml
services:
  aimusic:
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"
```

3. **å®‰å…¨åŠ å›º**ï¼š
```bash
# ä½¿ç”¨éç‰¹æƒç«¯å£
docker run -p 8080:8080 --user 1001:1001 aimusic:latest

# åªè¯»æ ¹æ–‡ä»¶ç³»ç»Ÿ
docker run --read-only --tmpfs /tmp aimusic:latest
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
AIMusic/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main/
â”‚   â”‚   â”œâ”€â”€ java/com/aimusic/
â”‚   â”‚   â”‚   â”œâ”€â”€ config/                    # é…ç½®ç±»
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AiConfig.java          # AIæœåŠ¡é…ç½®
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AppConfig.java         # åº”ç”¨é…ç½®
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CacheConfig.java       # ç¼“å­˜é…ç½®
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ HttpClientConfig.java  # HTTPå®¢æˆ·ç«¯é…ç½®
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ InternationalizationConfig.java # å›½é™…åŒ–é…ç½®
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Knife4jConfig.java     # APIæ–‡æ¡£é…ç½®
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LoggingConfig.java     # æ—¥å¿—é…ç½®
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MonitoringConfig.java  # ç›‘æ§é…ç½®
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ProxyConfig.java       # ä»£ç†é…ç½®
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ SecurityConfig.java    # å®‰å…¨é…ç½®
â”‚   â”‚   â”‚   â”œâ”€â”€ controller/                # æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ CacheController.java   # ç¼“å­˜ç›‘æ§æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ GlobalExceptionHandler.java # å…¨å±€å¼‚å¸¸å¤„ç†
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ HealthController.java  # å¥åº·æ£€æŸ¥æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ MainController.java    # ä¸»æ§åˆ¶å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ service/                   # æœåŠ¡å±‚
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AiService.java         # AIæœåŠ¡å®ç°
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IAiService.java        # AIæœåŠ¡æ¥å£
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ IMusicService.java     # éŸ³ä¹æœåŠ¡æ¥å£
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ MusicService.java      # éŸ³ä¹æœåŠ¡å®ç°
â”‚   â”‚   â”‚   â”œâ”€â”€ dto/                       # æ•°æ®ä¼ è¾“å¯¹è±¡
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ AnswerResponse.java    # å›ç­”å“åº”
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ ApiResponse.java       # APIå“åº”
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ MusicInfo.java         # éŸ³ä¹ä¿¡æ¯
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ QuestionRequest.java   # é—®é¢˜è¯·æ±‚
â”‚   â”‚   â”‚   â”œâ”€â”€ exception/                 # å¼‚å¸¸å¤„ç†
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ BusinessException.java # ä¸šåŠ¡å¼‚å¸¸
â”‚   â”‚   â”‚   â””â”€â”€ AimusicApplication.java    # ä¸»å¯åŠ¨ç±»
â”‚   â”‚   â””â”€â”€ resources/
â”‚   â”‚       â”œâ”€â”€ application.yml            # åŸºç¡€é…ç½®
â”‚   â”‚       â”œâ”€â”€ application-dev.yml        # å¼€å‘ç¯å¢ƒé…ç½®
â”‚   â”‚       â”œâ”€â”€ application-prod.yml       # ç”Ÿäº§ç¯å¢ƒé…ç½®
â”‚   â”‚       â”œâ”€â”€ application-local.yml      # æœ¬åœ°é…ç½®ï¼ˆä¸æäº¤ï¼‰
â”‚   â”‚       â”œâ”€â”€ application-test.yml       # æµ‹è¯•ç¯å¢ƒé…ç½®
â”‚   â”‚       â”œâ”€â”€ messages/                  # å›½é™…åŒ–æ–‡ä»¶
â”‚   â”‚       â”‚   â”œâ”€â”€ messages_zh_CN.properties # ä¸­æ–‡
â”‚   â”‚       â”‚   â””â”€â”€ messages_en_US.properties # è‹±æ–‡
â”‚   â”‚       â”œâ”€â”€ static/                    # é™æ€èµ„æº
â”‚   â”‚       â”‚   â”œâ”€â”€ css/style.css          # æ ·å¼æ–‡ä»¶
â”‚   â”‚       â”‚   â”œâ”€â”€ js/                    # JavaScriptæ–‡ä»¶
â”‚   â”‚       â”‚   â””â”€â”€ favicon.ico            # ç½‘ç«™å›¾æ ‡
â”‚   â”‚       â””â”€â”€ templates/                 # æ¨¡æ¿æ–‡ä»¶
â”‚   â”‚           â””â”€â”€ index.html             # ä¸»é¡µæ¨¡æ¿
â”‚   â””â”€â”€ test/                              # æµ‹è¯•ä»£ç 
â”‚       â”œâ”€â”€ java/com/aimusic/
â”‚       â”‚   â”œâ”€â”€ CacheTest.java             # ç¼“å­˜æµ‹è¯•
â”‚       â”‚   â””â”€â”€ ...                        # å…¶ä»–æµ‹è¯•ç±»
â”‚       â””â”€â”€ resources/
â”‚           â””â”€â”€ application-test.yml       # æµ‹è¯•é…ç½®
â”œâ”€â”€ target/                                # ç¼–è¯‘è¾“å‡º
â”œâ”€â”€ logs/                                  # æ—¥å¿—æ–‡ä»¶
â”‚   â””â”€â”€ aimusic.log                        # åº”ç”¨æ—¥å¿—
â”œâ”€â”€ .dockerignore                          # Dockerå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ .env.example                           # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ .gitignore                             # Gitå¿½ç•¥æ–‡ä»¶
â”œâ”€â”€ Dockerfile                             # Dockeræ„å»ºæ–‡ä»¶
â”œâ”€â”€ docker-compose.yml                     # Docker Composeé…ç½®
â”œâ”€â”€ cache-test-guide.md                    # ç¼“å­˜æµ‹è¯•æŒ‡å—
â”œâ”€â”€ pom.xml                                # Mavené…ç½®
â””â”€â”€ README.md                              # é¡¹ç›®è¯´æ˜
```

## ğŸ”§ é…ç½®è¯´æ˜

### å¤šç¯å¢ƒé…ç½®

é¡¹ç›®æ”¯æŒå¤šç¯å¢ƒé…ç½®ç®¡ç†ï¼š

- **application.yml** - åŸºç¡€é…ç½®ï¼ŒåŒ…å«é€šç”¨è®¾ç½®
- **application-dev.yml** - å¼€å‘ç¯å¢ƒé…ç½®
- **application-prod.yml** - ç”Ÿäº§ç¯å¢ƒé…ç½®
- **application-local.yml** - æœ¬åœ°å¼€å‘é…ç½®ï¼ˆä¸æäº¤åˆ°gitï¼‰

### AIæœåŠ¡é…ç½®

**å¼€å‘ç¯å¢ƒ** (`application-dev.yml`)ï¼š
```yaml
ai:
  base-url: https://api.openai.com/v1
  api-key: your-development-api-key
  model-name: gpt-4
  timeout: 30
```

**ç”Ÿäº§ç¯å¢ƒ** (`application-prod.yml`)ï¼š
```yaml
ai:
  base-url: ${AI_BASE_URL}
  api-key: ${AI_API_KEY}
  model-name: ${AI_MODEL_NAME:gpt-4}
  timeout: ${AI_TIMEOUT:60}
```

### ä»£ç†é…ç½®

å¦‚æœéœ€è¦é€šè¿‡ä»£ç†è®¿é—®AIæœåŠ¡ï¼š

```yaml
proxy:
  enabled: ${PROXY_ENABLED:false}
  host: ${PROXY_HOST:127.0.0.1}
  port: ${PROXY_PORT:8080}
```

### å®‰å…¨é…ç½®

**é‡è¦**ï¼šSpring Securityä¼šè‡ªåŠ¨ç”Ÿæˆé»˜è®¤å¯†ç ï¼Œç”Ÿäº§ç¯å¢ƒå¿…é¡»é…ç½®è‡ªå®šä¹‰è®¤è¯ï¼š

```yaml
spring:
  security:
    user:
      name: ${SECURITY_USER_NAME:admin}
      password: ${SECURITY_USER_PASSWORD}
      roles: ${SECURITY_USER_ROLES:ADMIN}
```

### ç¼“å­˜é…ç½®

ç³»ç»Ÿä½¿ç”¨Caffeineç¼“å­˜æ¥æå‡æ€§èƒ½ï¼š

```yaml
spring:
  cache:
    type: caffeine
    caffeine:
      spec: maximumSize=1000,expireAfterWrite=24h,expireAfterAccess=6h
```

### åº”ç”¨é…ç½®

```yaml
app:
  max-question-length: 500  # é—®é¢˜æœ€å¤§é•¿åº¦é™åˆ¶
```

### æ—¥å¿—é…ç½®

**å¼€å‘ç¯å¢ƒ**ï¼š
```yaml
logging:
  level:
    com.aimusic: DEBUG
    org.springframework.cache: DEBUG
    root: INFO
```

**ç”Ÿäº§ç¯å¢ƒ**ï¼š
```yaml
logging:
  level:
    com.aimusic: INFO
    root: WARN
  file:
    name: logs/aimusic.log
    max-size: 50MB
    max-history: 30
```

## ğŸŒ å›½é™…åŒ–æ”¯æŒ

ç³»ç»Ÿæ”¯æŒä¸­æ–‡å’Œè‹±æ–‡ä¸¤ç§è¯­è¨€ï¼š

- ä¸­æ–‡ï¼šè®¿é—® `/?lang=zh_CN`
- è‹±æ–‡ï¼šè®¿é—® `/?lang=en_US`

å›½é™…åŒ–æ–‡ä»¶ä½ç½®ï¼š
- `src/main/resources/messages/messages_zh_CN.properties`
- `src/main/resources/messages/messages_en_US.properties`

## ğŸ“Š APIæ–‡æ¡£

é¡¹ç›®é›†æˆäº†Knife4jï¼Œæä¾›å®Œæ•´çš„APIæ–‡æ¡£ï¼š

- **Knife4jæ–‡æ¡£**ï¼šhttp://localhost:8080/doc.html
- **Swagger UI**ï¼šhttp://localhost:8080/swagger-ui.html
- **OpenAPI JSON**ï¼šhttp://localhost:8080/v3/api-docs

### ä¸»è¦APIç«¯ç‚¹

- `POST /api/ask` - æäº¤é—®é¢˜è·å–AIå›ç­”
- `GET /api/health` - å¥åº·æ£€æŸ¥
- `GET /api/cache/stats` - ç¼“å­˜ç»Ÿè®¡ä¿¡æ¯
- `GET /api/cache/list` - ç¼“å­˜åˆ—è¡¨
- `GET /api/cache/clear/{cacheName}` - æ¸…ç©ºæŒ‡å®šç¼“å­˜

## ğŸ” ç›‘æ§å’Œå¥åº·æ£€æŸ¥

ç³»ç»Ÿé›†æˆäº†Spring Boot Actuatorå’Œè‡ªå®šä¹‰ç›‘æ§ï¼š

### Actuatorç«¯ç‚¹
- å¥åº·æ£€æŸ¥ï¼š`GET /actuator/health`
- åº”ç”¨ä¿¡æ¯ï¼š`GET /actuator/info`
- æŒ‡æ ‡ç›‘æ§ï¼š`GET /actuator/metrics`

### ç¼“å­˜ç›‘æ§
- ç¼“å­˜ç»Ÿè®¡ï¼š`GET /api/cache/stats`
- ç¼“å­˜è¯¦æƒ…ï¼š`GET /api/cache/stats/{cacheName}`
- ç¼“å­˜ç®¡ç†ï¼š`GET /api/cache/clear/{cacheName}`

### è‡ªå®šä¹‰å¥åº·æ£€æŸ¥
- AIæœåŠ¡çŠ¶æ€ï¼š`GET /api/health/ai`
- ç³»ç»ŸçŠ¶æ€ï¼š`GET /api/health/system`

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
mvn test

# è¿è¡Œç‰¹å®šæµ‹è¯•
mvn test -Dtest=CacheTest

# è¿è¡Œé›†æˆæµ‹è¯•
mvn verify
```

### ç¼“å­˜æµ‹è¯•

é¡¹ç›®æä¾›äº†ä¸“é—¨çš„ç¼“å­˜æµ‹è¯•æŒ‡å—ï¼Œè¯¦è§ `cache-test-guide.md`ï¼š

```bash
# è¿è¡Œç¼“å­˜æµ‹è¯•
mvn test -Dtest=CacheTest

# æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡
curl http://localhost:8080/api/cache/stats
```

## ğŸ›¡ï¸ å®‰å…¨ç‰¹æ€§

### Spring Securityé…ç½®
- CSRFä¿æŠ¤
- å®‰å…¨å¤´é…ç½®ï¼ˆé˜²ç‚¹å‡»åŠ«æŒã€HSTSç­‰ï¼‰
- CORSè·¨åŸŸæ”¯æŒ

### å…¨å±€å¼‚å¸¸å¤„ç†
- æ™ºèƒ½å¼‚å¸¸è¿‡æ»¤ï¼ˆå¿½ç•¥æµè§ˆå™¨è‡ªåŠ¨è¯·æ±‚ï¼‰
- å›½é™…åŒ–é”™è¯¯æ¶ˆæ¯
- ç»Ÿä¸€é”™è¯¯å“åº”æ ¼å¼

### è¾“å…¥éªŒè¯
- é—®é¢˜é•¿åº¦é™åˆ¶
- å‚æ•°éªŒè¯
- ä¸šåŠ¡è§„åˆ™éªŒè¯

## ğŸ“ å¼€å‘æŒ‡å—

### æ·»åŠ æ–°åŠŸèƒ½

1. åœ¨ `controller` åŒ…ä¸­æ·»åŠ æ–°çš„æ§åˆ¶å™¨
2. åœ¨ `service` åŒ…ä¸­å®ç°ä¸šåŠ¡é€»è¾‘
3. åœ¨ `dto` åŒ…ä¸­å®šä¹‰æ•°æ®ä¼ è¾“å¯¹è±¡
4. æ›´æ–°å›½é™…åŒ–æ–‡ä»¶
5. ç¼–å†™å•å…ƒæµ‹è¯•
6. æ›´æ–°APIæ–‡æ¡£

### å¼€å‘ç¯å¢ƒè®¾ç½®

1. **IDEé…ç½®**ï¼š
   - æ¨èä½¿ç”¨IntelliJ IDEAæˆ–Eclipse
   - å®‰è£…Lombokæ’ä»¶
   - é…ç½®ä»£ç æ ¼å¼åŒ–è§„åˆ™

2. **æœ¬åœ°å¼€å‘**ï¼š
```bash
# ä½¿ç”¨æœ¬åœ°é…ç½®æ–‡ä»¶
cp src/main/resources/application-local.yml.example src/main/resources/application-local.yml

# ç¼–è¾‘æœ¬åœ°é…ç½®
vim src/main/resources/application-local.yml

# å¯åŠ¨åº”ç”¨
mvn spring-boot:run -Dspring-boot.run.profiles=local
```

3. **çƒ­é‡è½½å¼€å‘**ï¼š
```xml
<!-- å·²åŒ…å«åœ¨pom.xmlä¸­ -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-devtools</artifactId>
    <scope>runtime</scope>
    <optional>true</optional>
</dependency>
```

### ä»£ç è§„èŒƒ

- **Javaç‰ˆæœ¬**ï¼šä½¿ç”¨Java 21è¯­æ³•ç‰¹æ€§
- **æ¡†æ¶è§„èŒƒ**ï¼šéµå¾ªSpring Bootæœ€ä½³å®è·µ
- **ä»£ç ç®€åŒ–**ï¼šä½¿ç”¨Lombokå‡å°‘æ ·æ¿ä»£ç 
- **å¼‚å¸¸å¤„ç†**ï¼šç»Ÿä¸€å¼‚å¸¸å¤„ç†æœºåˆ¶
- **æ€§èƒ½ä¼˜åŒ–**ï¼šåˆç†ä½¿ç”¨ç¼“å­˜æå‡æ€§èƒ½
- **å®‰å…¨è§„èŒƒ**ï¼šæ•æ„Ÿä¿¡æ¯é€šè¿‡ç¯å¢ƒå˜é‡é…ç½®
- **æ–‡æ¡£è§„èŒƒ**ï¼šæ·»åŠ é€‚å½“çš„æ³¨é‡Šå’Œæ–‡æ¡£
- **æµ‹è¯•è§„èŒƒ**ï¼šç¼–å†™å•å…ƒæµ‹è¯•
- **æ—¥å¿—è§„èŒƒ**ï¼šä½¿ç”¨SLF4Jè¿›è¡Œæ—¥å¿—è®°å½•
- **APIè§„èŒƒ**ï¼šéµå¾ªRESTful APIè®¾è®¡åŸåˆ™

### é¡¹ç›®ç»“æ„è§„èŒƒ

```
src/main/java/com/aimusic/
â”œâ”€â”€ controller/     # æ§åˆ¶å™¨å±‚
â”œâ”€â”€ service/        # æœåŠ¡å±‚
â”œâ”€â”€ dto/           # æ•°æ®ä¼ è¾“å¯¹è±¡
â”œâ”€â”€ exception/     # å¼‚å¸¸å¤„ç†
â”œâ”€â”€ config/        # é…ç½®ç±»
â””â”€â”€ AiMusicApplication.java  # å¯åŠ¨ç±»
```

### Gitå·¥ä½œæµ

1. **åˆ†æ”¯ç®¡ç†**ï¼š
```bash
# åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
git checkout -b feature/new-feature

# æäº¤ä»£ç 
git add .
git commit -m "feat: add new feature"

# æ¨é€åˆ†æ”¯
git push origin feature/new-feature
```

2. **æäº¤è§„èŒƒ**ï¼š
- `feat`: æ–°åŠŸèƒ½
- `fix`: ä¿®å¤bug
- `docs`: æ–‡æ¡£æ›´æ–°
- `style`: ä»£ç æ ¼å¼åŒ–
- `refactor`: ä»£ç é‡æ„
- `test`: æµ‹è¯•ç›¸å…³
- `chore`: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·çš„å˜åŠ¨

### æµ‹è¯•æŒ‡å—

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
mvn test

# è¿è¡Œç‰¹å®šæµ‹è¯•ç±»
mvn test -Dtest=AiServiceTest

# ç”Ÿæˆæµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š
mvn jacoco:report
```

### ç¼“å­˜ä½¿ç”¨

```java
@Cacheable(value = "musicCache", key = "#artist + '_' + #song")
public MusicInfo searchSong(String artist, String song) {
    // å®ç°é€»è¾‘
}
```

### å¼‚å¸¸å¤„ç†

```java
@ExceptionHandler(BusinessException.class)
public ResponseEntity<ApiResponse<Void>> handleBusinessException(BusinessException ex) {
    // å¤„ç†é€»è¾‘
}
```

## â“ å¸¸è§é—®é¢˜

### ğŸ”§ éƒ¨ç½²ç›¸å…³é—®é¢˜

**Q: Dockeræ„å»ºå¤±è´¥æ€ä¹ˆåŠï¼Ÿ**

A: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. ç¡®ä¿Dockerç‰ˆæœ¬æ”¯æŒå¤šé˜¶æ®µæ„å»º
2. æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼ŒMavenä¾èµ–ä¸‹è½½å¯èƒ½è¾ƒæ…¢
3. æ¸…ç†Dockerç¼“å­˜ï¼š`docker system prune -a`
4. æ£€æŸ¥.dockerignoreæ–‡ä»¶æ˜¯å¦æ­£ç¡®

**Q: å®¹å™¨å¯åŠ¨åæ— æ³•è®¿é—®ï¼Ÿ**

A: æ’æŸ¥æ­¥éª¤ï¼š
```bash
# æ£€æŸ¥å®¹å™¨çŠ¶æ€
docker ps -a

# æŸ¥çœ‹å®¹å™¨æ—¥å¿—
docker logs aimusic

# æ£€æŸ¥ç«¯å£æ˜ å°„
docker port aimusic

# è¿›å…¥å®¹å™¨è°ƒè¯•
docker exec -it aimusic /bin/sh
```

### ğŸ” å®‰å…¨ç›¸å…³é—®é¢˜

**Q: Spring Securityé»˜è®¤å¯†ç åœ¨å“ªé‡Œï¼Ÿ**

A: å¯åŠ¨æ—¥å¿—ä¸­ä¼šæ˜¾ç¤ºï¼š
```
Using generated security password: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
```
ç”Ÿäº§ç¯å¢ƒå¿…é¡»é…ç½®è‡ªå®šä¹‰å¯†ç ï¼š
```yaml
spring:
  security:
    user:
      name: admin
      password: your-secure-password
```

**Q: å¦‚ä½•ç¦ç”¨Spring Securityï¼Ÿ**

A: åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ï¼š
```yaml
spring:
  autoconfigure:
    exclude: org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration
```

### ğŸ¤– AIæœåŠ¡é—®é¢˜

**Q: AIæœåŠ¡è°ƒç”¨å¤±è´¥æ€ä¹ˆåŠï¼Ÿ**

A: è¯·æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. **APIå¯†é’¥éªŒè¯**ï¼š
   ```bash
   curl -H "Authorization: Bearer $AI_API_KEY" $AI_BASE_URL/models
   ```
2. **ç½‘ç»œè¿æ¥æµ‹è¯•**ï¼š
   ```bash
   curl -I $AI_BASE_URL
   ```
3. **ä»£ç†è®¾ç½®æ£€æŸ¥**ï¼šç¡®è®¤ä»£ç†é…ç½®æ­£ç¡®
4. **æœåŠ¡çŠ¶æ€ç¡®è®¤**ï¼šæ£€æŸ¥AIæœåŠ¡æä¾›å•†çŠ¶æ€é¡µé¢

**Q: AIå“åº”é€Ÿåº¦æ…¢æ€ä¹ˆåŠï¼Ÿ**

A: ä¼˜åŒ–å»ºè®®ï¼š
1. è°ƒæ•´è¶…æ—¶æ—¶é—´ï¼š`ai.timeout=60`
2. ä½¿ç”¨æ›´å¿«çš„æ¨¡å‹
3. å¯ç”¨è¯·æ±‚ç¼“å­˜
4. é…ç½®åˆé€‚çš„ä»£ç†æœåŠ¡å™¨

### ğŸ”„ ç¼“å­˜ç›¸å…³é—®é¢˜

**Q: ç¼“å­˜ä¸ç”Ÿæ•ˆæ€ä¹ˆåŠï¼Ÿ**

A: æ£€æŸ¥ä»¥ä¸‹é…ç½®ï¼š
1. **æ³¨è§£æ£€æŸ¥**ï¼šç¡®ä¿`@Cacheable`æ³¨è§£æ­£ç¡®
2. **é…ç½®éªŒè¯**ï¼š
   ```yaml
   spring:
     cache:
       type: caffeine
   ```
3. **æ–¹æ³•è°ƒç”¨**ï¼šç¡®ä¿é€šè¿‡Springä»£ç†è°ƒç”¨
4. **ç¼“å­˜æ¸…ç†**ï¼šæ‰‹åŠ¨æ¸…ç†ç¼“å­˜æµ‹è¯•

**Q: å¦‚ä½•ç›‘æ§ç¼“å­˜çŠ¶æ€ï¼Ÿ**

A: ä½¿ç”¨Actuatorç«¯ç‚¹ï¼š
```bash
# æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡
curl http://localhost:8080/actuator/caches

# æ¸…ç†ç‰¹å®šç¼“å­˜
curl -X DELETE http://localhost:8080/actuator/caches/musicCache
```

### ğŸŒ ç½‘ç»œç›¸å…³é—®é¢˜

**Q: é¡µé¢æ˜¾ç¤ºä¹±ç æ€ä¹ˆåŠï¼Ÿ**

A: ç¡®ä¿ä»¥ä¸‹è®¾ç½®æ­£ç¡®ï¼š
1. **æµè§ˆå™¨ç¼–ç **ï¼šè®¾ç½®ä¸ºUTF-8
2. **æœåŠ¡å™¨é…ç½®**ï¼š
   ```yaml
   server:
     servlet:
       encoding:
         charset: UTF-8
         force: true
   ```
3. **å“åº”å¤´æ£€æŸ¥**ï¼šç¡®è®¤Content-Typeæ­£ç¡®

**Q: APIæ–‡æ¡£æ— æ³•è®¿é—®ï¼Ÿ**

A: ç¡®è®¤ä»¥ä¸‹å‡ ç‚¹ï¼š
1. **åº”ç”¨çŠ¶æ€**ï¼šæ£€æŸ¥åº”ç”¨æ˜¯å¦æ­£å¸¸å¯åŠ¨
2. **ç«¯å£æ£€æŸ¥**ï¼š`netstat -tlnp | grep 8080`
3. **é˜²ç«å¢™è®¾ç½®**ï¼šç¡®ä¿ç«¯å£å¼€æ”¾
4. **è·¯å¾„ç¡®è®¤**ï¼šè®¿é—®`/swagger-ui.html`æˆ–`/actuator/health`

### ğŸ“Š æ€§èƒ½ç›¸å…³é—®é¢˜

**Q: åº”ç”¨å¯åŠ¨æ…¢æ€ä¹ˆåŠï¼Ÿ**

A: ä¼˜åŒ–å»ºè®®ï¼š
1. **JVMå‚æ•°è°ƒä¼˜**ï¼š
   ```bash
   java -Xms512m -Xmx1g -XX:+UseG1GC -jar app.jar
   ```
2. **ä¾èµ–ä¼˜åŒ–**ï¼šç§»é™¤ä¸å¿…è¦çš„ä¾èµ–
3. **é…ç½®è°ƒæ•´**ï¼šç¦ç”¨ä¸éœ€è¦çš„è‡ªåŠ¨é…ç½®

**Q: å†…å­˜ä½¿ç”¨è¿‡é«˜æ€ä¹ˆåŠï¼Ÿ**

A: æ’æŸ¥æ­¥éª¤ï¼š
1. **å†…å­˜åˆ†æ**ï¼šä½¿ç”¨JProfileræˆ–VisualVM
2. **ç¼“å­˜é…ç½®**ï¼šè°ƒæ•´ç¼“å­˜å¤§å°é™åˆ¶
3. **GCè°ƒä¼˜**ï¼šé€‰æ‹©åˆé€‚çš„åƒåœ¾æ”¶é›†å™¨
4. **èµ„æºé™åˆ¶**ï¼šåœ¨Dockerä¸­è®¾ç½®å†…å­˜é™åˆ¶

## ğŸ”„ ç‰ˆæœ¬æ›´æ–°

### v2.0.0 (2025-06-21) - å½“å‰ç‰ˆæœ¬
- âœ¨ **æ–°å¢åŠŸèƒ½**ï¼š
  - å¤šç¯å¢ƒé…ç½®æ”¯æŒï¼ˆdev/prod/localï¼‰
  - Dockerå¤šé˜¶æ®µæ„å»º
  - å®Œæ•´çš„Docker Composeéƒ¨ç½²æ–¹æ¡ˆ
  - ç¯å¢ƒå˜é‡é…ç½®æ¨¡æ¿
  - å¢å¼ºçš„å®‰å…¨é…ç½®
- ğŸ”§ **æ”¹è¿›ä¼˜åŒ–**ï¼š
  - ä¼˜åŒ–é¡¹ç›®ç»“æ„å’Œé…ç½®ç®¡ç†
  - å®Œå–„æ–‡æ¡£å’Œéƒ¨ç½²æŒ‡å—
  - å¢å¼ºé”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•
  - æ€§èƒ½ä¼˜åŒ–å’Œç¼“å­˜æ”¹è¿›
- ğŸ› **é—®é¢˜ä¿®å¤**ï¼š
  - ä¿®å¤Dockeræ„å»ºé—®é¢˜
  - è§£å†³é…ç½®æ–‡ä»¶åŠ è½½é—®é¢˜
  - ä¼˜åŒ–èµ„æºä½¿ç”¨å’Œå†…å­˜ç®¡ç†

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿æ‰€æœ‰å½¢å¼çš„è´¡çŒ®ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

### è´¡çŒ®æµç¨‹

1. **Forké¡¹ç›®**
   ```bash
   git clone https://github.com/your-username/aimusic.git
   cd aimusic
   ```

2. **åˆ›å»ºåŠŸèƒ½åˆ†æ”¯**
   ```bash
   git checkout -b feature/amazing-feature
   ```

3. **æäº¤æ›´æ”¹**
   ```bash
   git commit -m 'feat: add amazing feature'
   ```

4. **æ¨é€åˆ†æ”¯**
   ```bash
   git push origin feature/amazing-feature
   ```

5. **åˆ›å»ºPull Request**

### è´¡çŒ®ç±»å‹

- ğŸ› **Bugä¿®å¤**ï¼šä¿®å¤ç°æœ‰åŠŸèƒ½çš„é—®é¢˜
- âœ¨ **æ–°åŠŸèƒ½**ï¼šæ·»åŠ æ–°çš„åŠŸèƒ½ç‰¹æ€§
- ğŸ“š **æ–‡æ¡£æ”¹è¿›**ï¼šå®Œå–„æ–‡æ¡£å’Œæ³¨é‡Š
- ğŸ¨ **ä»£ç ä¼˜åŒ–**ï¼šæ”¹è¿›ä»£ç ç»“æ„å’Œæ€§èƒ½
- ğŸ§ª **æµ‹è¯•å¢å¼º**ï¼šæ·»åŠ æˆ–æ”¹è¿›æµ‹è¯•ç”¨ä¾‹
- ğŸ”§ **é…ç½®ä¼˜åŒ–**ï¼šæ”¹è¿›é…ç½®å’Œéƒ¨ç½²æµç¨‹

### ä»£ç å®¡æŸ¥æ ‡å‡†

- ä»£ç ç¬¦åˆé¡¹ç›®è§„èŒƒ
- åŒ…å«é€‚å½“çš„æµ‹è¯•ç”¨ä¾‹
- æ–‡æ¡£æ›´æ–°å®Œæ•´
- é€šè¿‡æ‰€æœ‰CIæ£€æŸ¥
- åŠŸèƒ½å®Œæ•´ä¸”ç¨³å®š

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ä»¥ä¸‹æ–¹å¼è”ç³»ï¼š

- ğŸ“§ **é‚®ç®±**ï¼šyour-email@example.com
- ğŸ› **é—®é¢˜åé¦ˆ**ï¼š[GitHub Issues](https://github.com/your-username/aimusic/issues)
- ğŸ’¬ **åŠŸèƒ½å»ºè®®**ï¼š[GitHub Discussions](https://github.com/your-username/aimusic/discussions)
- ğŸ“– **æ–‡æ¡£é—®é¢˜**ï¼š[Wikié¡µé¢](https://github.com/your-username/aimusic/wiki)

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®å’Œè´¡çŒ®è€…ï¼š

- [Spring Boot](https://spring.io/projects/spring-boot) - åº”ç”¨æ¡†æ¶
- [Thymeleaf](https://www.thymeleaf.org/) - æ¨¡æ¿å¼•æ“
- [Caffeine](https://github.com/ben-manes/caffeine) - ç¼“å­˜åº“
- [Docker](https://www.docker.com/) - å®¹å™¨åŒ–å¹³å°
- æ‰€æœ‰è´¡çŒ®è€…å’Œç”¨æˆ·çš„æ”¯æŒ

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ªæ˜Ÿæ ‡ï¼

ğŸ”— **é¡¹ç›®é“¾æ¥**ï¼š[https://github.com/your-username/aimusic](https://github.com/your-username/aimusic)

---

**è®©éŸ³ä¹ä¸ºä½ çš„äººç”ŸæŒ‡è·¯** ğŸµ

*Built with â¤ï¸ using Spring Boot and AI*